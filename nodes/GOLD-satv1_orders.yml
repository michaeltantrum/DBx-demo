fileVersion: 1
id: 357895b7-bb8e-44ac-9ddb-88cd9e8f6e3e
name: satv1_orders
operation:
  config:
    postSQL: ""
    preSQL: ""
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: GOLD
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2990c1d3-0685-466e-9753-b2abcf0845af
          stepCounter: 357895b7-bb8e-44ac-9ddb-88cd9e8f6e3e
        config:
          is_hk: true
        dataType: STRING
        description: ""
        name: h_order_key
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1891301c-c613-478f-ac20-d685f3326ee2
                stepCounter: c0b233ff-d29d-4a82-bfa0-8c727c44018f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a8de13b-6018-47f8-8379-3a48c3d1c900
          stepCounter: 357895b7-bb8e-44ac-9ddb-88cd9e8f6e3e
        config: {}
        dataType: LONG
        description: ""
        name: o_orderkey
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6cad13ce-4b42-41e5-8cd0-dd87fb2d38f0
                stepCounter: c0b233ff-d29d-4a82-bfa0-8c727c44018f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ddd01f2-a63d-45a8-94e4-d5756307353a
          stepCounter: 357895b7-bb8e-44ac-9ddb-88cd9e8f6e3e
        config: {}
        dataType: LONG
        description: ""
        name: o_custkey
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad3e06fa-648a-4649-abc3-9b899a352e4b
                stepCounter: c0b233ff-d29d-4a82-bfa0-8c727c44018f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74d9d997-b691-49ac-9785-7241fedae4f6
          stepCounter: 357895b7-bb8e-44ac-9ddb-88cd9e8f6e3e
        config: {}
        dataType: STRING
        description: ""
        name: o_orderstatus
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b16cb4a-d812-4647-80d8-248f6ec708a8
                stepCounter: c0b233ff-d29d-4a82-bfa0-8c727c44018f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e09f0ccc-49f6-4278-ac9e-bda122f15490
          stepCounter: 357895b7-bb8e-44ac-9ddb-88cd9e8f6e3e
        config: {}
        dataType: DECIMAL
        description: ""
        name: o_totalprice
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5a9a4d0-3d71-48ef-8490-85192b025ddf
                stepCounter: c0b233ff-d29d-4a82-bfa0-8c727c44018f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83727ac2-9b33-4fbd-80e8-897373f1ecd6
          stepCounter: 357895b7-bb8e-44ac-9ddb-88cd9e8f6e3e
        config: {}
        dataType: DATE
        description: ""
        name: o_orderdate
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 393b498d-b7ff-47cb-81cb-9b8e18b10977
                stepCounter: c0b233ff-d29d-4a82-bfa0-8c727c44018f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eee26dff-1ed6-4fb7-a75c-ccad5ec1d65c
          stepCounter: 357895b7-bb8e-44ac-9ddb-88cd9e8f6e3e
        config: {}
        dataType: STRING
        description: ""
        name: o_orderpriority
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31ed70d5-38fe-4dcd-ba3e-85ce7d924ba9
                stepCounter: c0b233ff-d29d-4a82-bfa0-8c727c44018f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec13268f-e34d-49f4-aa9b-d999ca0ad48d
          stepCounter: 357895b7-bb8e-44ac-9ddb-88cd9e8f6e3e
        config: {}
        dataType: STRING
        description: ""
        name: o_clerk
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68db1da5-8ba6-459d-a4a5-8f3c53c8a32e
                stepCounter: c0b233ff-d29d-4a82-bfa0-8c727c44018f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a241037-9dd8-4b91-8e37-2aad3d3cb31a
          stepCounter: 357895b7-bb8e-44ac-9ddb-88cd9e8f6e3e
        config: {}
        dataType: INT
        description: ""
        name: o_shippriority
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: faf269e3-405b-417a-97d1-ba4dbf685871
                stepCounter: c0b233ff-d29d-4a82-bfa0-8c727c44018f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 745c9379-20df-4bfa-b59e-935d40c0f6c4
          stepCounter: 357895b7-bb8e-44ac-9ddb-88cd9e8f6e3e
        config: {}
        dataType: STRING
        description: ""
        name: o_comment
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfa7fb3c-bcb0-46c3-948b-aa9036af96e9
                stepCounter: c0b233ff-d29d-4a82-bfa0-8c727c44018f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: faa4aa3d-29ac-4e1c-997e-bd83ff192b58
          stepCounter: 357895b7-bb8e-44ac-9ddb-88cd9e8f6e3e
        config: {}
        dataType: TIMESTAMP
        description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
        name: ldts
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4465b93c-6abf-4a02-843e-31950e88b22d
                stepCounter: c0b233ff-d29d-4a82-bfa0-8c727c44018f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c7e25d5-024c-42e2-8ef3-46075e2e49e9
          stepCounter: 357895b7-bb8e-44ac-9ddb-88cd9e8f6e3e
        config: {}
        dataType: STRING
        description: The Record Source (RSRC) describes the source of this data.
        name: rsrc
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 248229de-f05c-4fb2-bb21-ca18aefce304
                stepCounter: c0b233ff-d29d-4a82-bfa0-8c727c44018f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6aab2d7a-f5ed-4c95-a318-c1de14abd919
          stepCounter: 357895b7-bb8e-44ac-9ddb-88cd9e8f6e3e
        config: {}
        dataType: STRING
        description: ""
        name: s_order_hash
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3fb0fdd-c36e-4b41-aff6-934086a9c3fb
                stepCounter: c0b233ff-d29d-4a82-bfa0-8c727c44018f
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: c7a8f301-390a-459e-90d1-3dd920aa4899
          stepCounter: 357895b7-bb8e-44ac-9ddb-88cd9e8f6e3e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        is_system_ledts: true
        name: LEDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              COALESCE(LEAD(`{{ datavault4coalesce.config.ldts_alias }}` - INTERVAL '1 MICROSECOND') 
              OVER (PARTITION BY `{{ get_value_by_column_attribute("is_hk") }}` 
              ORDER BY `{{ datavault4coalesce.config.ldts_alias }}`), {{ datavault4coalesce__string_to_timestamp(datavault4coalesce.config.timestamp_format, datavault4coalesce.config.end_of_all_times) }})
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: f02751a6-7a89-4965-9d33-906c72bdfef5
          stepCounter: 357895b7-bb8e-44ac-9ddb-88cd9e8f6e3e
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        is_system_current_col: true
        name: IS_CURRENT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE 
                WHEN 
                  LEAD(`{{ datavault4coalesce.config.ldts_alias }}` - INTERVAL '1 MICROSECOND') 
                  OVER (PARTITION BY `{{ get_value_by_column_attribute("is_hk") }}` 
                  ORDER BY `{{ datavault4coalesce.config.ldts_alias }}`) IS NULL 
                THEN TRUE 
                ELSE FALSE 
              END
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: GOLD
            nodeName: satv0_orders
        join:
          joinCondition: FROM {{ ref('GOLD', 'satv0_orders') }} `satv0_orders`
        name: satv1_orders
        noLinkRefs: []
  name: satv1_orders
  overrideSQL: false
  schema: ""
  sqlType: "9"
  type: sql
  version: 1
type: Node
